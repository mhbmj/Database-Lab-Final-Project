# میانگین بارش سالانه هر شهر محاسبه شود و شهرهایی که بیشترین بارش متوسط سالانه را دارند استخراج شوند.

داده‌های مهم:


`Rainfall: CityID, rainfall`

`City: CityID, CityName`


ابتدا باید اطلاعات مربوط به بارش که در جدول `Rainfall` ذخیره شده‌اند، به اطلاعات نام شهرها که در جدول `City` قرار دارند، مرتبط کنیم. از آنجا که جدول `Rainfall` فقط آی دی های هر شهر `(CityID)` را نگه می‌دارد و نام شهر در جدول `City` قرار دارد، باید از `INNER JOIN` استفاده کنیم:

به همین منظور از کوئری زیر استفاده می کنیم:

   
    SELECT 
        c.CityName,
        AVG(r.Rainfall) AS AvgRainfall
    FROM Rainfall R
    INNER JOIN City c ON R.CityID = c.CityID
    GROUP BY c.CityName
    ORDER BY AvgRainfall DESC;

نتایج:

<img width="500" height="600" alt="L3-1" src="https://github.com/user-attachments/assets/ad2cca73-211a-4f97-b18a-a599d280dccc" />

این کوئری به منظور محاسبه میانگین بارش کل هر شهر طراحی شده است و از ترکیب جدول‌های Rainfall و City استفاده می‌کند. ابتدا با استفاده از INNER JOIN داده‌های بارش با اطلاعات نام شهرها ترکیب می‌شوند تا هر رکورد بارش به شهر مربوطه مرتبط شود، سپس با استفاده از GROUP BY بر اساس نام شهر، میانگین کل بارش هر شهر محاسبه می‌شود زیرا هر شهر دارای چندین رکورد بارش در طول زمان است و لازم است داده‌ها تجمیع شوند تا یک مقدار میانگین واحد برای هر شهر به دست آید. در نهایت، با ORDER BY میانگین بارش به صورت نزولی مرتب‌سازی انجام می‌شود تا شهرهایی که بیشترین میانگین بارش را دارند در صدر جدول قرار گیرند و مشاهده و تحلیل آن‌ها ساده‌تر شود.
# محاسبه میانگین بارش ماهانه و تحلیل بهترین و بدترین ماه‌ها برای هر شهر (2010–2020)
داده های مهم از هر جدول:

`Rainfall: CityID, year, month, rainfall`

`City: CityID, CityName`


میانگین بارش ماهانه هر شهر:
ابتدا رکوردهای بارش برای هر شهر و هر ماه در بازه سال‌های ۲۰۱۰ تا ۲۰۲۰ فیلتر می‌شوند. سپس با استفاده از GROUP BY، میانگین بارش هر شهر-ماه محاسبه می‌شود.

بهترین و بدترین ماه‌ها:
بهترین ماه برای هر شهر به عنوان ماهی تعریف می‌شود که بیشترین میانگین بارش را داشته باشد و بدترین ماه همان ماهی است که کمترین میانگین بارش را داشته باشد. :

      SELECT
          C.CityName,
          R.Month,
          AVG(R.Rainfall) AS AvgRain
      FROM City C
      INNER JOIN Rainfall R
      ON C.CityID = R.CityID
      WHERE R.Year BETWEEN 2010 AND 2020
      GROUP BY C.CityName, R.Month
      ORDER BY C.CityName ASC, AvgRain DESC;
نتایج:

<img width="200" height="550" alt="L3-2" src="https://github.com/user-attachments/assets/ae70da98-a906-45ba-88fc-5a90401acce0" />

 این کوئری به منظور محاسبه میانگین بارش ماهانه هر شهر در بازه زمانی ۲۰۱۰ تا ۲۰۲۰ طراحی شده است و از ترکیب جدول‌های City و Rainfall استفاده می‌کند.
 ابتدا با استفاده از INNER JOIN داده‌های بارش با اطلاعات نام شهرها ترکیب می‌شوند تا هر رکورد بارش با شهر مربوطه مرتبط شود، سپس با شرط WHERE رکوردهای خارج از بازه سال‌های مورد نظر حذف می‌شوند و فقط داده‌های ۲۰۱۰ تا ۲۰۲۰ در تحلیل باقی می‌مانند.
 پس از آن، با استفاده از GROUP BY بر اساس نام شهر و ماه، میانگین بارش هر شهر برای هر ماه محاسبه می‌شود، زیرا هر شهر برای هر ماه چندین رکورد دارد و لازم است این داده‌ها تجمیع شوند. در نهایت، با ORDER BY ابتدا بر اساس نام شهر به صورت صعودی و سپس بر اساس میانگین بارش به صورت نزولی مرتب‌سازی انجام می‌شود تا ماه‌های پر بارش هر شهر به راحتی قابل مشاهده باشند و تحلیل آن‌ها ساده‌تر شود.

# شهرهایی که بارش آن‌ها بالاتر از میانگین کل کشور است و بررسی چگونگی ارتفاع آن‌ها نسبت به میانگین ارتفاع و مرتب سازی نتایج به طوری که بیشترین بارش و بیشترین ارتفاع در صدر جدول باشد.

داده‌های مهم:

`Rainfall: CityID, year, month, rainfall, elevation`

`City: CityID, CityName, latitude, longitude, climateID`

ارتفاع (elevation) در جدول `Rainfall` است و میانگین بارش و ارتفاع کل کشور باید محاسبه شود.

      SELECT
          C.CityName,
          R.AvgRain AS AvgRainfall,
          R.AvgElevation AS AvgElevation
      FROM City C
      INNER JOIN (
          SELECT 
              CityID,
              AVG(Rainfall) AS AvgRain,
              AVG(Elevation) AS AvgElevation
          FROM Rainfall
          GROUP BY CityID
          HAVING AVG(Rainfall) > (SELECT AVG(Rainfall) FROM Rainfall)
      ) R ON C.CityID = R.CityID
      ORDER BY R.AvgRain DESC, R.AvgElevation DESC;

نتایج:

<img width="437" height="225" alt="L3-3" src="https://github.com/user-attachments/assets/e63e57f5-e8d9-4a5a-a173-7321d1628d60" />

این کوئری به منظور یافتن شهرهایی طراحی شده است که میانگین بارش آن‌ها بالاتر از میانگین کل کشور است و اطلاعات ارتفاع آن‌ها نیز بررسی شود. ابتدا با استفاده از زیرکوئری (R) میانگین بارش (AvgRain) و میانگین ارتفاع (AvgElevation) هر شهر محاسبه می‌شود و فقط شهرهایی که میانگین بارششان بیشتر از میانگین کل کشور است نگه داشته می‌شوند. سپس با INNER JOIN داده‌های هر شهر با جدول City ترکیب می‌شود تا نام شهر به نتایج اضافه شود. در نهایت، خروجی بر اساس میانگین بارش به صورت نزولی و سپس میانگین ارتفاع به صورت نزولی مرتب می‌شود تا شهرهایی که بیشترین بارش و بیشترین ارتفاع دارند در صدر جدول قرار گیرند.


